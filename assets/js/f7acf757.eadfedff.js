"use strict";(self.webpackChunkstacklok=self.webpackChunkstacklok||[]).push([[5294],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>f});var n=r(67294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var p=n.createContext({}),s=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,a=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=s(r),m=i,f=d["".concat(p,".").concat(m)]||d[m]||c[m]||a;return r?n.createElement(f,o(o({ref:t},u),{},{components:r})):n.createElement(f,o({ref:t},u))}));function f(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=r.length,o=new Array(a);o[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[d]="string"==typeof e?e:i,o[1]=l;for(var s=2;s<a;s++)o[s]=r[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},79357:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var n=r(87462),i=(r(67294),r(3905));const a={title:"Automatic Remediations",sidebar_position:70},o="Automatic Remediation with Minder",l={unversionedId:"getting_started/remediations",id:"getting_started/remediations",title:"Automatic Remediations",description:"In Creating your first profile, we wrote a rule to open a",source:"@site/docs/getting_started/remediations.md",sourceDirName:"getting_started",slug:"/getting_started/remediations",permalink:"/getting_started/remediations",draft:!1,tags:[],version:"current",sidebarPosition:70,frontMatter:{title:"Automatic Remediations",sidebar_position:70},sidebar:"minder",previous:{title:"Creating your first profile",permalink:"/getting_started/first_profile"},next:{title:"Creating a profile",permalink:"/how-to/create_profile"}},p={},s=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Creating a profile with <code>remediate: on</code>",id:"creating-a-profile-with-remediate-on",level:2},{value:"Current limitations",id:"current-limitations",level:2}],u={toc:s},d="wrapper";function c(e){let{components:t,...r}=e;return(0,i.kt)(d,(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"automatic-remediation-with-minder"},"Automatic Remediation with Minder"),(0,i.kt)("p",null,"In ",(0,i.kt)("a",{parentName:"p",href:"/getting_started/first_profile"},"Creating your first profile"),", we wrote a rule to open a\nsecurity advisory when repo configuration drifted from the configured profile\nin Minder.  In this tutorial, we will show how Minder can automatically\nresolve the misconfiguration and ensure that enrolled repos have secret\nscanning enabled.  Secret scanning is one of several settings which can be\nmanaged by Minder.  When you apply a Minder profile to enrolled repositories,\nit will remediate (fix) the setting if it is changed to violate the profile."),(0,i.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/getting_started/install_cli"},"The ",(0,i.kt)("inlineCode",{parentName:"a"},"minder")," CLI application")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/getting_started/login"},"A Minder account")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/getting_started/login#enrolling-the-github-provider"},"An enrolled GitHub token")," that is either an Owner in the organization or an Admin on the repositories"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/getting_started/first_profile#register-repositories"},"A registered repository in Minder")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/getting_started/first_profile#creating-and-applying-profiles"},"The ",(0,i.kt)("inlineCode",{parentName:"a"},"secret_scanning")," rule type")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/getting_started/first_profile#creating-and-applying-profiles"},"A policy to open security advisories when secret scanning is off"))),(0,i.kt)("h2",{id:"creating-a-profile-with-remediate-on"},"Creating a profile with ",(0,i.kt)("inlineCode",{parentName:"h2"},"remediate: on")),(0,i.kt)("p",null,"Minder doesn't currently support editing profiles, so we will create a new profile with ",(0,i.kt)("inlineCode",{parentName:"p"},"remediate: on"),"."),(0,i.kt)("p",null,"Create a new file called ",(0,i.kt)("inlineCode",{parentName:"p"},"profile-remediate.yaml"),".\nPaste the following profile definition into the newly created file, setting the ",(0,i.kt)("inlineCode",{parentName:"p"},"remediate")," attribute to ",(0,i.kt)("inlineCode",{parentName:"p"},"on"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'---\nversion: v1\ntype: profile\nname: github-profile-remediate\ncontext:\n  provider: github\nalert: "on"\nremediate: "on"\nrepository:\n  - type: secret_scanning\n    def:\n      enabled: true\n')),(0,i.kt)("p",null,"Create the profile in Minder:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"minder profile create -f profile-remediate.yaml\n")),(0,i.kt)("p",null,"Check the status of the profile:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"minder profile status list --profile github-profile-remediate\n")),(0,i.kt)("p",null,'With remediation on, the profile status should be "Success" when the repository has been updated to match the profile.\nIf you navigate to your repository settings with your browser, you should see that the secret scanning\nfeature is enabled. Toggling the feature off should trigger a new profile status check and the\nsecret scanning feature should be enabled again in GitHub.'),(0,i.kt)("h2",{id:"current-limitations"},"Current limitations"),(0,i.kt)("p",null,"At the time of writing, not all ",(0,i.kt)("inlineCode",{parentName:"p"},"rule-type")," objects support remediation. To find out which\nrule types support remediation, you can run:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"minder ruletype get -i ${ID} -oyaml\n")),(0,i.kt)("p",null,"and look for the ",(0,i.kt)("inlineCode",{parentName:"p"},"remediate")," attribute. If it's not present, the rule type doesn't support\nremediation. Alternatively, browse the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/stacklok/minder-rules-and-profiles/tree/main/rule-types/github"},"rule types directory"),"\nof the minder-rules-and-profiles repository."),(0,i.kt)("p",null,"Furthermore, remediations that open a pull request such as the ",(0,i.kt)("inlineCode",{parentName:"p"},"dependabot")," rule type only attempt\nto replace the target file, overwriting its contents. This means that if you want to keep the current\nchanges, you need to merge the contents manually."))}c.isMDXComponent=!0}}]);